# 1장 자바 8,9,10,11
## 1.2.3 동작 파라미터화
* 자바 8에서는 메서드를 다른 메서드의 인수로 넘겨줄 수 있다.
## 1.2.4 병렬성과 공유 가변 데이터
* 병렬성을 공짜로 얻을 수 있다. 대신, 스트림 메서드로 전달하는 코드의 동작 방식을 조금 바꿔야 한다.
* 스트림 메서드로 전달하는 코드는 다른 코드와 동시에 실행하더라도 안전하게 실행될 수 있어야 한다.
* 다른 코드와 동시에 실행하더라도 안전하게 실행할 수 있는 코드를 만드려면 공유된 가변 데이터에 접근하지 않아야 한다.
* 위와 같은 조건을 만족하는 함수를 순수 함수, 부작용 없는 함수, 상태 없는 함수라 부른다.
* 스트림을 이용하면 기존 자바 스레드 API보다 쉽게 병렬성을 활용할 수 있다.  
```
parallelStream()
```
## 1.2.5 
* 자바 8에서 함수형 프로그래밍을 도입함으로써 객체지향 프로그램의 장점을 유지하면서 어떤 문제를 효율적으로 적용할 수 있는 또 다른 도구를 얻었다.

## 1.3
* 자바에서의 함수는 수학적인 함수처럼 사용되며 부작용을 일으키지 않는 함수를 의미한다.
* 자바의 다양한 구조체(메서드, 클래스 같은)는 프로그램을 실행하는 동안 자유롭게 전달될 수 없다. (이급시민)
* 자바 8에서는 위와같은 이급 시민을 일급시민으로 바꿀 수 있는 기능을 추가했다. 이 말은, 런타임에 메서드를 전달할 수 있다는 말이다.
```
function, consumer, bifunction...
```

##1.3.1
* 자바 8에서 메서드를 값으로 취급할 수 있는 기능은 스트림 같은 다른 자바 8 기능의 토대를 제공했다.  
1. 메서드 참조
> 기존에는 File 클래스에 이미 isHidden이 있는데, FileFilter로 감싼다음 FilFilter를 인스턴스화 해서 사용한다.
```
File[] hiddenFiles = new FIle(".").listFiles(new FileFilter() {
    public boolean accept(File file) {
        return file.isHidden();
    }
});
```
> 메서드 참조를 사용해서 아래와 같이 간단히 바꿀 수 있다.
```
File[] hiddenFiles = new FIle(".").listFiles(File::isHidden);
```
메서드 참조(::)는 이 메서드를 값으로 사용하라는 의미이다.
기존에 객체참조로 객체를 주고받은 것처럼 메서드 참조로 메서드를 값으로 주고받을 수 있게 되었다.
2. 람다: 익명 함수  
자바 8에서는 메서드를 일급값으로 취급할 뿐 아니라 람다를 포함하여 함수도 값으로 취급할 수 있다. 
```
File[] files = new File(".").listFiles(file -> file.isHidden());
```

##1.3.3 메서드 전달에서 람다로
메서드 참조, 람다 어떤것을 사용 기준은?
* 한 번만 사용할 메서드는 따로 정의를 구현할 필요가 없다. 람다로 구현하자.
* 메서드가 여러번 반복되거나, 조금 복잡한 동작을 수행해야 해서 람다가 길어지면 코드가 수행하는 일을 잘 설명하는 이름을 가진 메서드를 정의하고 메서드 참조를 사용하자.  
(코드의 명확성이 우선시 되어야 한다)

## 1.4 스트림
* 컬렉션에서는 for-each 루프를 이용하여 각 요소를 반복하면서 작업을 수행했다. (외부 반복)
* 스트림 API를 이용하면 루프를 신경쓸 필요 없다. 스트림 API 라이브러리 내부에서 모든 데이터가 처리된다 (내부 반복)
* for-each는 단일 cpu를 사용하지만, 스트림을 사용하면, 멀티 코어 각각 CPU 코어에 작업을 할당해서 병렬로 처리해 시간을 줄일 수 있다.

## 1.4.1 멀티스레딩은 어렵다
* 자바 8 이전 버전에서 멀티스레딩을 코드로 구현해서 병렬성을 이용하기 쉽지 않았다.
* 자바 8은 스트림 API로 '컬렉션을 처리하면서 발생하는 모호함과 반복적인 코드 문제', '멀티코어 활용 어려움' 두 가지 문제 모두 해결했다.
* 스트림 API는 기존 for-each에서 반복되는 패턴을 라이브러리로 제공한다.  
주어진 조건에 따라 데이터를 필터링, 추출, 그룹화 등의 기능을 스트림 API에서 볼 수 있다.

> 순차 처리 방식
```
List<Apple> heavyApples = inventory.stream().filter((Apple a) -> a.getWeight() > 150).collect(toList());
```  
> 병렬 처리 방식  
> 컬렉션 포크로 각각 CPU에 처리해야할 apple들을 할당 -> 각각 CPU에서 할당된 apple을 필터링 -> 결과 합침
```
List<Apple> heavyApples = inventory.parallelStream().filter((Apple a) -> a.getWeight() > 150).collect(toList());
```   
* 함수형 프로그래밍에서 함수형이란 '함수를 일급값으로 사용한다'라는 의미도 있지만,  
'프로그램이 실행되는 동안 컴포넌트 간에 상호작용이 일어나지 않는다'라는 의미도 포함한다.

## 1.5 디폴트 메서드와 자바 모듈
* 자바 9는 모듈을 정의하는 문법을 제공하므로 이를 이용해 패키지 모음을 포함하는 모듈을 정의할 수 있다.
* 자바 8에서는 인터페이스를 쉽게 바꿀 수 있도록 default 메서드를 지원한다.
* 디폴트 메서드는 프로그램 구현에 도움을 주는 기능이 아니라 미래에 프로그램이 쉽게 변화할 수 있는 환경을 제공하는 기능이다.
* 자바 8 이전의 List<T>가 stream이나 parallelStream을 지원하게 할 수 있기 위해 가장 간단한 방법은   
List가 구현하는 인터페이스인 Collection 인터페이스에 stream 메서드를 추가하고 하위 클래스에서 메서드를 구현하는 것이다.  
하지만, 이 방법은 이미 Collection 인터페이스를 구현하는 모든 클래스가 추가된 메서드를 구현해야 하는 사실상 불가능한 이야기였다.  
기존 구현을 고치지 않고, 이미 공개된 인터페이스를 변경할 수 있기 위해 default 메서드가 추가되었다.
